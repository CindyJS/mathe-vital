<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    
    <title>TaylorArctan.cdy</title>
    <style type="text/css">
        * {
            margin: 0px;
            padding: 0px;
        }

        #CSConsole {
            background-color: #FAFAFA;
            border-top: 1px solid #333333;
            bottom: 0px;
            height: 200px;
            overflow-y: scroll;
            position: fixed;
            width: 100%;
        }
    </style>
    <link rel="stylesheet" href="https://cindyjs.org/dist/v0.8/CindyJS.css">
    <script type="text/javascript" src="https://cindyjs.org/dist/v0.8/Cindy.js"></script>
<script id="csdraw" type="text/x-cindyscript">

f(x):=arctan(x);
plot(f(x));
A.y=f(A.x);
p=-A.x;
a=p;
coeffs=
[-ArcTan(a), (1 + a^2)^(-1), a/(1 + a^2)^2, 
  (-1 + 3*a^2)/(3*(1 + a^2)^3), (-a + a^3)/(1 + a^2)^4, 
  (1 - 10*a^2 + 5*a^4)/(5*(1 + a^2)^5), (3*a - 10*a^3 + 3*a^5)/
   (3*(1 + a^2)^6), (-1 + 21*a^2 - 35*a^4 + 7*a^6)/(7*(1 + a^2)^7), 
  (-a + 7*a^3 - 7*a^5 + a^7)/(1 + a^2)^8, 
  (1 - 36*a^2 + 126*a^4 - 84*a^6 + 9*a^8)/(9*(1 + a^2)^9), 
  ((512*a^9)/(1 + a^2)^9 - (1024*a^7)/(1 + a^2)^8 + 
    (672*a^5)/(1 + a^2)^7 - (160*a^3)/(1 + a^2)^6 + (10*a)/(1 + a^2)^5)/
   (10*(1 + a^2)), ((1024*a^10)/(1 + a^2)^10 - (2304*a^8)/(1 + a^2)^9 + 
    (1792*a^6)/(1 + a^2)^8 - (560*a^4)/(1 + a^2)^7 + 
    (60*a^2)/(1 + a^2)^6 - (1 + a^2)^(-5))/(11*(1 + a^2)), 
  ((2048*a^11)/(1 + a^2)^11 - (5120*a^9)/(1 + a^2)^10 + 
    (4608*a^7)/(1 + a^2)^9 - (1792*a^5)/(1 + a^2)^8 + 
    (280*a^3)/(1 + a^2)^7 - (12*a)/(1 + a^2)^6)/(12*(1 + a^2)), 
  ((4096*a^12)/(1 + a^2)^12 - (11264*a^10)/(1 + a^2)^11 + 
    (11520*a^8)/(1 + a^2)^10 - (5376*a^6)/(1 + a^2)^9 + 
    (1120*a^4)/(1 + a^2)^8 - (84*a^2)/(1 + a^2)^7 + (1 + a^2)^(-6))/
   (13*(1 + a^2)), ((8192*a^13)/(1 + a^2)^13 - 
    (24576*a^11)/(1 + a^2)^12 + (28160*a^9)/(1 + a^2)^11 - 
    (15360*a^7)/(1 + a^2)^10 + (4032*a^5)/(1 + a^2)^9 - 
    (448*a^3)/(1 + a^2)^8 + (14*a)/(1 + a^2)^7)/(14*(1 + a^2)), 
  ((16384*a^14)/(1 + a^2)^14 - (53248*a^12)/(1 + a^2)^13 + 
    (67584*a^10)/(1 + a^2)^12 - (42240*a^8)/(1 + a^2)^11 + 
    (13440*a^6)/(1 + a^2)^10 - (2016*a^4)/(1 + a^2)^9 + 
    (112*a^2)/(1 + a^2)^8 - (1 + a^2)^(-7))/(15*(1 + a^2)), 
  ((32768*a^15)/(1 + a^2)^15 - (114688*a^13)/(1 + a^2)^14 + 
    (159744*a^11)/(1 + a^2)^13 - (112640*a^9)/(1 + a^2)^12 + 
    (42240*a^7)/(1 + a^2)^11 - (8064*a^5)/(1 + a^2)^10 + 
    (672*a^3)/(1 + a^2)^9 - (16*a)/(1 + a^2)^8)/(16*(1 + a^2)), 
  ((65536*a^16)/(1 + a^2)^16 - (245760*a^14)/(1 + a^2)^15 + 
    (372736*a^12)/(1 + a^2)^14 - (292864*a^10)/(1 + a^2)^13 + 
    (126720*a^8)/(1 + a^2)^12 - (29568*a^6)/(1 + a^2)^11 + 
    (3360*a^4)/(1 + a^2)^10 - (144*a^2)/(1 + a^2)^9 + (1 + a^2)^(-8))/
   (17*(1 + a^2)), ((131072*a^17)/(1 + a^2)^17 - 
    (524288*a^15)/(1 + a^2)^16 + (860160*a^13)/(1 + a^2)^15 - 
    (745472*a^11)/(1 + a^2)^14 + (366080*a^9)/(1 + a^2)^13 - 
    (101376*a^7)/(1 + a^2)^12 + (14784*a^5)/(1 + a^2)^11 - 
    (960*a^3)/(1 + a^2)^10 + (18*a)/(1 + a^2)^9)/(18*(1 + a^2)), 
  ((262144*a^18)/(1 + a^2)^18 - (1114112*a^16)/(1 + a^2)^17 + 
    (1966080*a^14)/(1 + a^2)^16 - (1863680*a^12)/(1 + a^2)^15 + 
    (1025024*a^10)/(1 + a^2)^14 - (329472*a^8)/(1 + a^2)^13 + 
    (59136*a^6)/(1 + a^2)^12 - (5280*a^4)/(1 + a^2)^11 + 
    (180*a^2)/(1 + a^2)^10 - (1 + a^2)^(-9))/(19*(1 + a^2)), 
  ((524288*a^19)/(1 + a^2)^19 - (2359296*a^17)/(1 + a^2)^18 + 
    (4456448*a^15)/(1 + a^2)^17 - (4587520*a^13)/(1 + a^2)^16 + 
    (2795520*a^11)/(1 + a^2)^15 - (1025024*a^9)/(1 + a^2)^14 + 
    (219648*a^7)/(1 + a^2)^13 - (25344*a^5)/(1 + a^2)^12 + 
    (1320*a^3)/(1 + a^2)^11 - (20*a)/(1 + a^2)^10)/(20*(1 + a^2))];

fa=1;
factors=[1]++apply(1..30,i,fa=fa*i;fa);
n=round(|B,D|*2)+1;

t(x):=sum(1..n,i,((x+p)^(i-1))*coeffs_i);
plot(max(min(t(x),20),-20),color->(0.8,0,0));

drawtext(D+(0.2,0.2),"n="+(n-1));

//apply(1..20,i,draw(E+(i,0),E+(i,coeffs_i)))

;
</script>
    <script type="text/javascript">
var cdy = CindyJS({
  scripts: "cs*",
  defaultAppearance: {
    dimDependent: 0.7,
    fontFamily: "sans-serif",
    lineSize: 1,
    pointSize: 5.0,
    textsize: 12.0
  },
  angleUnit: "Â°",
  geometry: [
    {name: "A", type: "Free", pos: [0.0, 0.0, 4.0], color: [1.0, 0.0, 0.0], alpha: 0.8999999761581421, labeled: true, printname: "p"},
    {name: "B", type: "Free", pos: [4.0, -2.857142857142857, -0.5714285714285714], color: [0.0, 0.0, 0.0], alpha: 0.8999999761581421, size: 2.0},
    {name: "C", type: "Free", pos: [-2.4, -4.0, -0.8], color: [0.0, 0.0, 0.0], alpha: 0.8999999761581421, size: 2.0},
    {name: "a", type: "Segment", color: [0.0, 0.0, 1.0], args: ["B", "C"], alpha: 0.8999999761581421},
    {name: "D", type: "PointOnSegment", pos: [4.0, -3.552802749244034, -0.7105605498488068], color: [1.0, 1.0, 1.0], args: ["a"], alpha: 0.8999999761581421},
    {name: "E", type: "Free", pos: [4.0, -2.0938628158844765, -0.3610108303249097], color: [1.0, 0.0, 0.0], alpha: 0.8999999761581421, size: 0.0},
    {name: "Text0", type: "Text", pos: [-2.9520892715656797, -4.0, -0.7110081398882602], color: [0.0, 0.0, 0.0], fillcolor: [0.012, 0.655, 0.737], fillalpha: 0.20000000298023224, alpha: 0.8999999761581421, text: "Taylor expansion for\n    \n  $f(x)=arctan(x)$      \n\nAround a point $p$  \nthis expansion is:     \n $\\sum_{i=0}^n\\left({f^{(i)}(x-p)\\over i!}(x-p)^i\\right)$", textsize: 15.0}
  ],
  ports: [{
    id: "CSCanvas",
    width: 713,
    height: 404,
    transform: [{visibleRect: [-7.508359669045245, 6.668112819424687, 7.853076325299833, -2.0359827510036603]}],
    axes: true,
    grid: 1.0,
    snap: true,
    background: "rgb(168,176,192)"
  }],
  csconsole: false,
  cinderella: {build: 1901, version: [2, 9, 1901]}
});
    </script>
</head>
<body>
    <div id="CSCanvas"></div>
</body>
</html>